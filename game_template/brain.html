<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ê¹Œë‹¤ë¡œìš´ ë¸Œë ˆì¸ ê²Œì„</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Jua', sans-serif;
            touch-action: none;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
            20%, 40%, 60%, 80% { transform: translateX(10px); }
        }
        .shake { animation: shake 0.5s ease-in-out; }
        .draggable { cursor: grab; user-select: none; position: absolute; }
        .dragging { cursor: grabbing; z-index: 50; }
        .level-btn:disabled { background-color: #9ca3af; cursor: not-allowed; }
        .level-btn:disabled .level-lock { display: block; }
        .level-lock { display: none; }
    </style>
</head>
<body class="bg-blue-100 flex items-center justify-center min-h-screen">

    <div id="game-container" class="w-full max-w-md mx-auto bg-white rounded-2xl shadow-2xl p-6 text-center transition-all duration-500">
        
        <div id="start-screen">
            <h1 class="text-4xl font-bold text-blue-600 mb-4">ì¢…í•© ë‘ë‡Œ ê²Œì„</h1>
            <p class="text-gray-600 mb-8">100ê°œì˜ ë¯¸ë‹ˆê²Œì„ìœ¼ë¡œ ë‹¹ì‹ ì˜ ë‡Œë¥¼ ì‹œí—˜í•˜ì„¸ìš”!</p>
            <button id="start-button" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-4 px-4 rounded-xl text-2xl transition-transform transform hover:scale-105">
                ë„ì „í•˜ê¸°
            </button>
        </div>
        
        <div id="level-select-screen" class="hidden">
            <h1 class="text-3xl font-bold text-blue-600 mb-6">ë ˆë²¨ ì„ íƒ</h1>
            <div id="level-grid" class="grid grid-cols-5 gap-3">
                <!-- ë ˆë²¨ ë²„íŠ¼ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤. -->
            </div>
             <button id="back-to-menu-button" class="mt-6 w-full bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg">
                ì²˜ìŒìœ¼ë¡œ
            </button>
        </div>

        <div id="game-screen" class="hidden">
            <div class="flex justify-between items-center mb-4">
                 <button id="back-to-levels-button" class="text-2xl">â¬…ï¸</button>
                <span class="text-xl font-bold text-gray-500">ë ˆë²¨ <span id="level-indicator">1</span></span>
                <button id="hint-button" class="text-3xl">ğŸ’¡</button>
            </div>
            <h2 id="question" class="text-3xl font-bold text-gray-800 mb-6 min-h-[84px] flex items-center justify-center leading-snug"></h2>
            <div id="puzzle-area" class="relative w-full h-80 bg-gray-100 rounded-xl border-4 border-gray-200 overflow-hidden flex justify-center items-center flex-wrap gap-4 p-4"></div>
        </div>
    </div>

    <div id="success-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl p-8 text-center shadow-xl transform transition-all scale-95">
            <h3 class="text-4xl font-bold text-green-500 mb-4">ì„±ê³µ!</h3>
            <p class="text-gray-700 mb-6 text-xl">ì •ë§ ëŒ€ë‹¨í•´ìš”!</p>
            <div class="flex gap-4">
                 <button id="select-level-button" class="w-full bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-xl text-xl">ë ˆë²¨ ì„ íƒ</button>
                <button id="next-level-button" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-xl text-xl">ë‹¤ìŒ ë ˆë²¨</button>
            </div>
        </div>
    </div>
    
    <div id="hint-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl p-8 text-center shadow-xl transform transition-all">
            <h3 class="text-3xl font-bold text-yellow-500 mb-4">ğŸ’¡ íŒíŠ¸ ğŸ’¡</h3>
            <p id="hint-text" class="text-gray-700 mb-6 text-xl min-h-[60px]"></p>
            <button id="close-hint-button" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-4 rounded-xl text-xl">ì•Œê² ìŠµë‹ˆë‹¤!</button>
        </div>
    </div>

    <div id="game-complete-screen" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl p-8 text-center shadow-xl">
            <h3 class="text-4xl font-bold text-yellow-500 mb-4">ëª¨ë“  ë ˆë²¨ í´ë¦¬ì–´!</h3>
            <p class="text-gray-700 mb-6 text-xl">ë‹¹ì‹ ì€ ë¸Œë ˆì¸ ë§ˆìŠ¤í„°!</p>
            <button id="restart-button" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-4 rounded-xl text-2xl">
                ì²˜ìŒë¶€í„° ë‹¤ì‹œí•˜ê¸°
            </button>
        </div>
    </div>

    <script>
        // --- DOM Elements ---
        const gameContainer = document.getElementById('game-container');
        const startScreen = document.getElementById('start-screen');
        const levelSelectScreen = document.getElementById('level-select-screen');
        const gameScreen = document.getElementById('game-screen');
        const startButton = document.getElementById('start-button');
        const levelGrid = document.getElementById('level-grid');
        const backToMenuButton = document.getElementById('back-to-menu-button');
        const backToLevelsButton = document.getElementById('back-to-levels-button');
        const hintButton = document.getElementById('hint-button');
        const levelIndicator = document.getElementById('level-indicator');
        const questionEl = document.getElementById('question');
        const puzzleArea = document.getElementById('puzzle-area');
        const successModal = document.getElementById('success-modal');
        const selectLevelButton = document.getElementById('select-level-button');
        const nextLevelButton = document.getElementById('next-level-button');
        const hintModal = document.getElementById('hint-modal');
        const hintText = document.getElementById('hint-text');
        const closeHintButton = document.getElementById('close-hint-button');
        const gameCompleteScreen = document.getElementById('game-complete-screen');
        const restartButton = document.getElementById('restart-button');

        // --- Game State ---
        let currentLevelIndex = 0;
        let unlockedLevel = 100; // í…ŒìŠ¤íŠ¸ ëª¨ë“œ: ëª¨ë“  ë ˆë²¨ ì ê¸ˆ í•´ì œ. ì ê¸ˆì„ í™œì„±í™”í•˜ë ¤ë©´ ì´ ê°’ì„ 1ë¡œ ë°”ê¾¸ì„¸ìš”.
        let activeDraggable = null;
        let offsetX, offsetY;
        let patienceTimer;

        const TOTAL_LEVELS = 100;

        // --- All Levels Data ---
        const levels = [
            // 1-20
            { question: "ì´ ì¤‘ì—ì„œ ë‹¤ë¥¸ ì´ëª¨ì§€ëŠ” ë¬´ì—‡ì¼ê¹Œìš”?", setup: setupFindDifferent(['ğŸ¼', 'ğŸ¼', 'ğŸ¼', 'ğŸ»', 'ğŸ¼', 'ğŸ¼', 'ğŸ¼', 'ğŸ¼'], 'ğŸ»'), hint: "ë¬´ì–¸ê°€ í•˜ë‚˜ë§Œ ë‹¬ë¼ìš”. ê³°ê³°ì´ ìƒê°í•´ë³´ì„¸ìš”." },
            { question: "í† ë¼ì—ê²Œ ë‹¹ê·¼ì„ ì£¼ì„¸ìš”.", setup: setupDragAndDrop('ğŸ°', 'ğŸ¥•'), hint: "ë‹¹ê·¼ì„ ì§ì ‘ í† ë¼ì—ê²Œ ê°€ì ¸ë‹¤ì£¼ë©´ ì–´ë–¨ê¹Œìš”?" },
            { question: "ì½”ì½”ë„›ì„ ë”°ë ¤ë©´ ë‚˜ë¬´ë¥¼ í”ë“¤ì–´ì£¼ì„¸ìš”.", setup: setupShake('ğŸŒ´', 'ğŸ¥¥'), cleanup: () => window.removeEventListener('devicemotion', handleShake), hint: "ìŠ¤ë§ˆíŠ¸í°ì„ ì‹¤ì œë¡œ í”ë“¤ì–´ ë³´ì„¸ìš”!" },
            { question: "ê°€ì¥ <span id='trick-word' class='text-red-500 hover:text-red-700 cursor-pointer'>ë¹¨ê°„ìƒ‰</span> ê³¼ì¼ì„ í„°ì¹˜í•˜ì„¸ìš”.", setup: setupTrickWord(['ğŸ‡', 'ğŸŒ', 'ğŸˆ', 'ğŸ'], 'trick-word'), hint: "ë¬¸ì œì— ì“°ì—¬ìˆëŠ” 'ë¹¨ê°„ìƒ‰' ê¸€ìë¥¼ ë³´ì„¸ìš”." },
            { question: "ê¸€ì 'íŒŒë€ìƒ‰'ì„ ëˆ„ë¥´ì„¸ìš”.", setup: setupColorTextTrick(), hint: "ê¸€ìì˜ ìƒ‰ì´ ì•„ë‹ˆë¼ ê¸€ì ìì²´ë¥¼ ë³´ì„¸ìš”." },
            { question: "í‹°ì…”ì¸ ì— ìˆëŠ” êµ¬ë©ì€ ì´ ëª‡ ê°œì¼ê¹Œìš”?", setup: setupTshirtHoles(), hint: "ì•ë©´, ë’·ë©´, ê·¸ë¦¬ê³  ëª©ê³¼ íŒ”, ëª¸í†µ êµ¬ë©ê¹Œì§€ ì„¸ì–´ë³´ì„¸ìš”." },
            { question: "ê³ ì–‘ì´ê°€ ë°°ê³ íŒŒìš”. ìˆ¨ê²¨ì§„ ì¥ë¥¼ ì°¾ì•„ì£¼ì„¸ìš”.", setup: setupHiddenObject('ğŸˆ', 'ğŸ', 'ğŸ“¦'), hint: "ê³ ì–‘ì´ê°€ ìƒì ë’¤ì— ë¬´ì–¸ê°€ ìˆ¨ê¸´ ê²ƒ ê°™ì•„ìš”. ìƒìë¥¼ ì¹˜ì›Œë³´ì„¸ìš”." },
            { question: "ê°€ì¥ í° ìˆ«ìë¥¼ ë§Œë“¤ì–´ ë³´ì„¸ìš”.", setup: setupMakeLargestNumber(['7', '1', '9'], '971'), hint: "ìˆ«ìë“¤ì„ ë“œë˜ê·¸í•´ì„œ ìƒˆë¡œìš´ ìˆ«ìë¥¼ ì¡°í•©í•  ìˆ˜ ìˆì–´ìš”." },
            { question: "ì´ ë¬¸ì¥ ì–´ë”˜ê°€ì— ìˆ¨ì–´ìˆëŠ” ğŸ’ì„ ì°¾ìœ¼ì„¸ìš”.", setup: () => { puzzleArea.innerHTML = ''; document.getElementById('question').innerHTML = "ì´ ë¬¸ì¥ ì–´ë”˜ê°€ì— ìˆ¨ì–´ìˆëŠ” <span class='cursor-pointer' onclick='completeLevel()'>ğŸ’</span>ì„ ì°¾ìœ¼ì„¸ìš”."; }, hint: "ë¬¸ì œ ìì²´ì— ë‹¤ì´ì•„ëª¬ë“œê°€ ìˆ¨ì–´ìˆì–´ìš”." },
            { question: "ì–´ë‘¡ê²Œ ë§Œë“¤ì–´ ì£¼ì„¸ìš”.", setup: setupDragAway('â˜€ï¸'), hint: "í•˜ëŠ˜ì— ë–  ìˆëŠ” í•´ë¥¼ ì¹˜ì›Œë²„ë¦¬ë©´ ì–´ë‘ì›Œì§€ì§€ ì•Šì„ê¹Œìš”?" },
            { question: "5ì´ˆ ë™ì•ˆ ì•„ë¬´ê²ƒë„ ë§Œì§€ì§€ ë§ˆì„¸ìš”.", setup: () => { puzzleArea.innerHTML = '<div class="text-2xl">ê°€ë§Œíˆ...</div>'; patienceTimer = setTimeout(completeLevel, 5000); puzzleArea.addEventListener('click', handleWrongAnswer); }, cleanup: () => { clearTimeout(patienceTimer); puzzleArea.removeEventListener('click', handleWrongAnswer); }, hint: "ì •ë§ë¡œ ì•„ë¬´ê²ƒë„ ê±´ë“œë¦¬ì§€ ì•Šê³  5ì´ˆë¥¼ ê¸°ë‹¤ë ¤ë³´ì„¸ìš”." },
            { question: "ìƒìë¥¼ ì—´ë ¤ë©´ 'ì—´ë ¤ë¼ì°¸ê¹¨'ë¥¼ ì…ë ¥í•˜ì„¸ìš”.", setup: setupPasswordInput('ì—´ë ¤ë¼ì°¸ê¹¨', 'ğŸ“¦'), hint: "ì£¼ë¬¸ì„ í‚¤ë³´ë“œë¡œ ì§ì ‘ ì…ë ¥í•´ë³´ì„¸ìš”." },
            { question: "ê°€ì¥ ë¬´ê±°ìš´ ê²ƒì„ ê³ ë¥´ì„¸ìš”.", setup: setupFindDifferent(['ğŸˆ', 'ğŸ˜', 'â˜ï¸'], 'ğŸ˜', false), hint: "ìƒìƒ ì† ë¬´ê²Œê°€ ì•„ë‹ˆë¼ ì‹¤ì œ ë¬´ê²Œë¥¼ ìƒê°í•´ë³´ì„¸ìš”." },
            { question: "ì¥ê°€ íƒˆì¶œí•˜ë„ë¡ ë„ì™€ì£¼ì„¸ìš” ğŸ", setup: setupEscape('ğŸ'), hint: "ê²Œì„ í™”ë©´ ë°–ìœ¼ë¡œ ì¥ë¥¼ ëŒì–´ë‚´ ë³´ì„¸ìš”." },
            { question: "ì‚¬ê³¼ëŠ” ëª¨ë‘ ëª‡ ê°œì¼ê¹Œìš”?", setup: setupHiddenCount('ğŸ', 4, ['2', '3', '4']), hint: "í•˜ë‚˜ì˜ ì‚¬ê³¼ê°€ ë‹¤ë¥¸ ì‚¬ê³¼ë¥¼ ê°€ë¦¬ê³  ìˆì–´ìš”. ë“œë˜ê·¸ í•´ë³´ì„¸ìš”." },
            { question: "ë‹¤ìŒ ìˆœì„œì— ì˜¬ ì´ëª¨ì§€ëŠ”? ğŸ¶â†’ğŸ¦´, ğŸ°â†’ğŸ¥•, ğŸµâ†’?", setup: setupPattern(['ğŸŒ', 'ğŸ§€', 'ğŸŒ³'], 'ğŸŒ'), hint: "ë™ë¬¼ì´ ì¢‹ì•„í•˜ëŠ” ìŒì‹ì„ ìƒê°í•´ë³´ì„¸ìš”. ì›ìˆ­ì´ëŠ” ë­˜ ì¢‹ì•„í• ê¹Œìš”?" },
            { question: "ê½ƒì„ í”¼ì›Œì£¼ì„¸ìš”.", setup: setupCombine('ğŸŒ§ï¸', 'ğŸŒ±', 'ğŸŒ¸'), hint: "ë¹„êµ¬ë¦„ì„ ì”¨ì•— ìœ„ë¡œ ê°€ì ¸ê°€ë©´ ë¬¼ì„ ì¤„ ìˆ˜ ìˆì–´ìš”." },
            { question: "ê°€ì¥ í° <span id='trick-circle' class='cursor-pointer'>ì›</span>ì„ í„°ì¹˜í•˜ì„¸ìš”.", setup: setupTrickWord(['âš«', 'ğŸ”µ', 'ğŸ”´'], 'trick-circle'), hint: "ì´ëª¨ì§€ ë§ê³ , ë¬¸ì œì— ìˆëŠ” 'ì›' ê¸€ìë¥¼ ë³´ì„¸ìš”." },
            { question: "ì´ˆë¡ ë²„íŠ¼ì„ ëˆ„ë¥´ê¸° ì „ì—, íŒŒë€ ë²„íŠ¼ì„ ë¨¼ì € ëˆ„ë¥´ì„¸ìš”.", setup: setupSequenceButtons(), hint: "ë¬¸ì œë¥¼ ì˜ ì½ì–´ë³´ì„¸ìš”. íŒŒë€ ë²„íŠ¼ì„ ë¨¼ì €, ê·¸ ë‹¤ìŒì— ì´ˆë¡ ë²„íŠ¼!" },
            { question: "ê²Œì„ì„ ëë‚´ë ¤ë©´ ì´ ë ˆë²¨ì˜ ìˆ«ìë¥¼ ëˆ„ë¥´ì„¸ìš”.", setup: () => { puzzleArea.innerHTML = '<div class="text-4xl">ğŸ¤”</div>'; levelIndicator.parentElement.classList.add('cursor-pointer'); levelIndicator.parentElement.onclick = () => { completeLevel(); }; }, cleanup: () => { levelIndicator.parentElement.classList.remove('cursor-pointer'); levelIndicator.parentElement.onclick = null; }, hint: "í™”ë©´ ìƒë‹¨ì— ë³´ì´ëŠ” ë ˆë²¨ ìˆ«ìë¥¼ ëˆŒëŸ¬ë³´ì„¸ìš”." },
            
            // 21-40
            { question: "ë¶ˆì„ ëª¨ë‘ ë„ì„¸ìš”.", setup: setupClickToDisappear('ğŸ”¥', 3), hint: "ë¶ˆì„ ì†ê°€ë½ìœ¼ë¡œ ë¬¸ì§ˆëŸ¬ì„œ ëŒ ìˆ˜ ìˆì–´ìš”." },
            { question: "ê³ ì–‘ì´ë¥¼ ìˆ¨ê²¨ì£¼ì„¸ìš”.", setup: setupDragAndDrop('ğŸˆ', 'ğŸ“¦', true), hint: "ê³ ì–‘ì´ ìœ„ë¡œ ìƒìë¥¼ ë“œë˜ê·¸í•´ì„œ ë®ì–´ë³´ì„¸ìš”." },
            { question: "ê°€ì¥ ë†’ì€ ê³³ì— ìˆëŠ” <span id='bird-word' class='cursor-pointer'>ìƒˆ</span>ë¥¼ í„°ì¹˜í•˜ì„¸ìš”.", setup: setupTrickWord(['ğŸ¦', 'ğŸ¦…', 'ğŸ•Šï¸'], 'bird-word'), hint: "ë¬¸ì œì— ì“°ì—¬ìˆëŠ” 'ìƒˆ' ê¸€ìê°€ ê°€ì¥ ë†’ì´ ìˆì§€ ì•Šë‚˜ìš”?" },
            { question: "ì°¨ë¥¼ ì£¼ì°¨í•˜ì„¸ìš”.", setup: setupDragAndDrop('ğŸ…¿ï¸', 'ğŸš—'), hint: "ìë™ì°¨ë¥¼ ì£¼ì°¨ ê³µê°„(P)ìœ¼ë¡œ ì˜®ê²¨ë³´ì„¸ìš”." },
            { question: "ê±°ìš¸ì— ë¹„ì¹œ ëª¨ìŠµì€?", setup: setupFindDifferent(['ğŸ', 'd', 'p', 'q'], 'p', false), hint: "'p'ë¥¼ ì¢Œìš°ë¡œ ë’¤ì§‘ìœ¼ë©´ 'q'ê°€ ë©ë‹ˆë‹¤." },
            { question: "ğŸ+ğŸ=10, ğŸ+ğŸŒ=8, ğŸŒ=?", setup: setupRiddleWithOptions(['2', '3', '5'], '3'), hint: "ì‚¬ê³¼ í•˜ë‚˜ëŠ” 5, ë°”ë‚˜ë‚˜ í•˜ë‚˜ëŠ” 3ì…ë‹ˆë‹¤." },
            { question: "ì›ì˜ ê°œìˆ˜ëŠ”? 8809", setup: setupRiddleWithOptions(['4', '5', '6'], '6'), hint: "ìˆ«ì 8ì—ëŠ” ì›ì´ 2ê°œ, 0ì—ëŠ” 1ê°œ, 9ì—ëŠ” 1ê°œê°€ ìˆì–´ìš”." },
            { question: "ë³‘ì•„ë¦¬ë¥¼ ì–´ë¯¸ ë‹­ì—ê²Œ ë°ë ¤ë‹¤ì£¼ì„¸ìš”.", setup: setupDragAndDrop('ğŸ”', 'ğŸ¥'), hint: "ë³‘ì•„ë¦¬ë¥¼ ì–´ë¯¸ ë‹­ì—ê²Œ ì§ì ‘ ë°ë ¤ë‹¤ì£¼ì„¸ìš”." },
            { question: "ë¨¹ì„ ìˆ˜ ì—†ëŠ” ê²ƒì€?", setup: setupFindDifferent(['ğŸ”', 'ğŸ•', 'ğŸ‘Ÿ', 'ğŸ°'], 'ğŸ‘Ÿ'), hint: "ì‹ ë°œì€ ë¨¹ì„ ìˆ˜ ì—†ì–´ìš”!" },
            { question: "íœ´ëŒ€í°ì„ ë’¤ì§‘ì–´ ë³´ì„¸ìš”.", setup: setupDeviceOrientation(), cleanup: () => window.removeEventListener('deviceorientation', handleOrientation), hint: "ìŠ¤ë§ˆíŠ¸í°ì„ ì‹¤ì œë¡œ ê±°ê¾¸ë¡œ ë’¤ì§‘ì–´ë³´ì„¸ìš”." },
            { question: "ê°€ì¥ ê¸´ ë§‰ëŒ€ë¥¼ ê³ ë¥´ì„¸ìš”.", setup: setupDraggableLength(), hint: "ë§‰ëŒ€ë“¤ì„ ë“œë˜ê·¸í•´ì„œ ê¸¸ì´ë¥¼ ë¹„êµí•´ ë³´ì„¸ìš”." },
            { question: "ë²„íŠ¼ì„ 10ë²ˆ ëˆ„ë¥´ì„¸ìš”.", setup: setupClickCounter(10), hint: "ìˆ«ìê°€ 9ì—ì„œ ??ë¡œ ë°”ë€ë‹ˆë‹¤. ê·¸ë˜ë„ í•œ ë²ˆ ë” ëˆŒëŸ¬ë³´ì„¸ìš”." },
            { question: "ì½”ë¼ë¦¬ë¥¼ ëƒ‰ì¥ê³ ì— ë„£ì–´ë³´ì„¸ìš”.", setup: setupEnlargeAndDrop('ğŸ˜', 'ğŸ§Š'), hint: "ë¨¼ì € ëƒ‰ì¥ê³  ë¬¸ì„ ì—´ì–´ì•¼ì£ ! ëƒ‰ì¥ê³ ë¥¼ í„°ì¹˜í•´ì„œ í¬ê²Œ ë§Œë“œì„¸ìš”." },
            { question: "ëª¨ë‘ë¥¼ ê¹¨ì›Œì£¼ì„¸ìš”.", setup: setupClickToChange('ğŸ˜´', 'ğŸ˜€', 5), hint: "ëª¨ë“  ìëŠ” ì–¼êµ´ì„ í„°ì¹˜í•´ì„œ ê¹¨ì›Œì£¼ì„¸ìš”." },
            { question: "ê°€ì¥ ì™¼ìª½ì˜ ê³¼ì¼ì„ í„°ì¹˜í•˜ì„¸ìš”.", setup: setupDynamicTarget(), hint: "ìƒˆë¡œìš´ ê³¼ì¼ì´ ë‚˜íƒ€ë‚  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¸ë‹¤ê°€ ê°€ì¥ ì™¼ìª½ ê²ƒì„ ëˆ„ë¥´ì„¸ìš”." },
            { question: "ë¹„ë°€ë²ˆí˜¸ëŠ” 'password' ì…ë‹ˆë‹¤.", setup: setupPasswordInput('password', 'ğŸ”‘'), hint: "ë¹„ë°€ë²ˆí˜¸ëŠ” ë¬¸ì œì— ë‚˜ì™€ìˆëŠ” ê·¸ëŒ€ë¡œ 'password'ì…ë‹ˆë‹¤." },
            { question: "ì•„ì¹¨ì—” ë„¤ ë°œ, ì ì‹¬ì—” ë‘ ë°œ, ì €ë…ì—” ì„¸ ë°œì¸ ê²ƒì€?", setup: setupRiddleWithOptions(['ì˜ì', 'ì‚¬ëŒ', 'ë™ë¬¼'], 'ì‚¬ëŒ'), hint: "ì •ë‹µì€ ì‚¬ëŒì…ë‹ˆë‹¤. ì•„ê¸° ë•Œ ë„¤ ë°œ, ì–´ë¥¸ì¼ ë•Œ ë‘ ë°œ, ëŠ™ì–´ì„œ ì§€íŒ¡ì´ë¥¼ ì§šìœ¼ë©´ ì„¸ ë°œ." },
            { question: "ê±°ë¶ì´ê°€ ì´ê¸°ê²Œ í•´ì£¼ì„¸ìš”.", setup: setupMoveFinishLine('ğŸ¢', 'ğŸ'), hint: "ê²°ìŠ¹ì„ ì„ ê±°ë¶ì´ ìª½ìœ¼ë¡œ ì˜®ê²¨ë³´ì„¸ìš”." },
            { question: "ê°€ìœ„ë¥¼ ì´ê¸°ê²Œ í•´ì£¼ì„¸ìš”.", setup: setupDragAway(['âœŠ', 'âœ‹'], 'âœŒï¸'), hint: "ê°€ìœ„ëŠ” ë°”ìœ„ì™€ ë³´ë¥¼ ì´ê¸¸ ìˆ˜ ì—†ìœ¼ë‹ˆ... ì¹˜ì›Œë²„ë¦¬ì„¸ìš”!" },
            { question: "ì–‘ì„ ì„¸ì–´ë³´ì„¸ìš”.", setup: setupCountingGame('ğŸ‘', 8), hint: "ì¡¸ë¦´ ë•Œ ì–‘ì„ ì„¸ì£ ? ì–‘ì´ ì§€ë‚˜ê°€ëŠ” ê±¸ ë³´ê³  ìˆ«ìë¥¼ ë§ì¶°ë³´ì„¸ìš”." },

            // 41-60
            { question: "ê°€ì¥ ì–´ë‘ìš´ ìƒ‰ì„ í„°ì¹˜í•˜ì„¸ìš”.", setup: () => { questionEl.innerHTML = "ê°€ì¥ ì–´ë‘ìš´ <span class='cursor-pointer font-black' onclick='completeLevel()'>ìƒ‰</span>ì„ í„°ì¹˜í•˜ì„¸ìš”."; puzzleArea.innerHTML = '<div class="w-20 h-20 bg-gray-600"></div><div class="w-20 h-20 bg-gray-800"></div>'; }, hint: "ë¬¸ì œì— ìˆëŠ” 'ìƒ‰'ì´ë¼ëŠ” ê¸€ìê°€ ê°€ì¥ ì–´ë‘ìš´ ê²€ì€ìƒ‰ì…ë‹ˆë‹¤." },
            { question: "TVë¥¼ ì¼œì£¼ì„¸ìš”.", setup: setupClickablePart('ğŸ“º', '.5, .5, .1', completeLevel), hint: "TV í™”ë©´ ì˜¤ë¥¸ìª½ ì•„ë˜ì˜ ì‘ì€ ì „ì› ë²„íŠ¼ì„ ëˆŒëŸ¬ë³´ì„¸ìš”." },
            { question: "ìˆ˜ë°•ì„ ìª¼ê°œì£¼ì„¸ìš”.", setup: setupTwoFingerSwipe('ğŸ‰'), hint: "ë‘ ì†ê°€ë½ìœ¼ë¡œ í™”ë©´ì„ ìŠ¤ì™€ì´í”„í•´ì„œ ìˆ˜ë°•ì„ ê°ˆë¼ë³´ì„¸ìš”." },
            { question: "ì˜¤ë¥¸ìª½ì—ì„œ ë‘ ë²ˆì§¸ ì „ë“±ì„ ì¼œì„¸ìš”.", setup: setupLightSwitches(5, 3), hint: "ì˜¤ë¥¸ìª½ì—ì„œë¶€í„° ì„¸ì–´ë³´ì„¸ìš”. ë‘ ë²ˆì§¸ ì „ë“± ìŠ¤ìœ„ì¹˜ëŠ” ì–´ë””ì¼ê¹Œìš”?" },
            { question: "ì €ë¥¼ ì°¾ì•„ë³´ì„¸ìš”.", setup: setupFindDifferent(['ğŸ˜€', 'ğŸ˜‚', 'ğŸ˜', 'ğŸ˜‡', 'ğŸ§', 'ğŸ˜­'], 'ğŸ§'), hint: "ì•ˆê²½ì„ ì“°ê³  ìœ ì‹¬íˆ ë³´ëŠ” ì´ëª¨ì§€ê°€ ë°”ë¡œ 'ì €'ì…ë‹ˆë‹¤." },
            { question: "3 X 8 = ?", setup: setupPasswordInput('24', 'ğŸ§®'), hint: "ì •ë‹µì€ 24ì…ë‹ˆë‹¤." },
            { question: "íŒŒë¦¬ë¥¼ ì¡ì•„ì£¼ì„¸ìš”.", setup: setupCatchTheFly('ğŸ¦Ÿ'), hint: "íŒŒë¦¬ëŠ” ë§¤ìš° ë¹ ë¦…ë‹ˆë‹¤. ì˜ ì¡°ì¤€í•´ì„œ í„°ì¹˜í•˜ì„¸ìš”!" },
            { question: "ì €ìš¸ì˜ ê· í˜•ì„ ë§ì¶”ì„¸ìš”.", setup: setupBalanceScale('âš–ï¸', 'ğŸ§±', 3), hint: "ì €ìš¸ ìœ„ì— ìˆëŠ” ë¬¼ê±´ë“¤ì„ ëª¨ë‘ ì¹˜ì›Œë²„ë¦¬ì„¸ìš”." },
            { question: "ë¨¸ë¦¬ì¹´ë½ì€ ëª‡ ê°œì¼ê¹Œìš”?", setup: setupRiddleWithOptions(['1000', '1', '0'], '0', 'ğŸ§‘â€ğŸ¦²'), hint: "ì´ëª¨ì§€ëŠ” ëŒ€ë¨¸ë¦¬ì…ë‹ˆë‹¤. ë¨¸ë¦¬ì¹´ë½ì´ ì—†ì–´ìš”." },
            { question: "í† ë¼ëŠ” ì–´ë””ì— ìˆ¨ì—ˆì„ê¹Œìš”?", setup: setupShellGame('ğŸ©', 'ğŸ°'), hint: "ì–´ë–¤ ëª¨ì ì•„ë˜ì— í† ë¼ê°€ ìˆ¨ì–´ìˆì„ê¹Œìš”? í•˜ë‚˜ì”© ëˆŒëŸ¬ë³´ì„¸ìš”." },
            { question: "ìš°ìœ ë¥¼ í”ë“¤ì–´ ì´ˆì½”ìš°ìœ ë¥¼ ë§Œë“œì„¸ìš”.", setup: setupShakeToChange('ğŸ¥›', 'ğŸ«', 'ğŸ§‹'), hint: "ìŠ¤ë§ˆíŠ¸í°ì„ í”ë“¤ì–´ì„œ ìš°ìœ ì™€ ì´ˆì½œë¦¿ì„ ì„ì–´ì£¼ì„¸ìš”." },
            { question: "ìë™ì°¨ì— ê¸°ë¦„ì„ ë„£ì–´ì£¼ì„¸ìš”.", setup: setupDragAndDrop('â›½', 'ğŸš—'), hint: "ì£¼ìœ ê¸°ë¥¼ ìë™ì°¨ ì£¼ìœ êµ¬ë¡œ ë“œë˜ê·¸í•˜ì„¸ìš”." },
            { question: "ì´ ì¤‘ì—ì„œ ì†Œë¦¬ê°€ ë‚˜ëŠ” ê²ƒì€?", setup: setupFindDifferent(['ğŸ””', 'ğŸ“–', 'ğŸª¨'], 'ğŸ””'), hint: "ì¢…(bell)ì„ ëˆ„ë¥´ë©´ ì†Œë¦¬ê°€ ë‚˜ì£ ." },
            { question: "í™”ë©´ì„ ê¹¨ë—í•˜ê²Œ ë‹¦ì•„ì£¼ì„¸ìš”.", setup: setupWipeScreen('ğŸ§½'), hint: "ìŠ¤í€ì§€ë¥¼ ë“œë˜ê·¸í•´ì„œ í™”ë©´ì˜ ì–¼ë£©ì„ ë¬¸ì§ˆëŸ¬ ë‹¦ì•„ë³´ì„¸ìš”." },
            { question: "ê³µì„ ê³¨ëŒ€ì— ë„£ìœ¼ì„¸ìš”.", setup: setupMoveTarget('âš½', 'ğŸ¥…'), hint: "ê³¨ëŒ€ë¥¼ ì›€ì§ì—¬ì„œ ê³µì„ ë°›ì„ ìˆ˜ ìˆì–´ìš”." },
            { question: "í˜„ì¬ ì‹œê°ì€?", setup: setupCurrentTime(), hint: "ë‹¹ì‹ ì˜ ìŠ¤ë§ˆíŠ¸í°ì— í‘œì‹œëœ í˜„ì¬ ì‹œê°ì„ ê·¸ëŒ€ë¡œ ì…ë ¥í•˜ì„¸ìš”." },
            { question: "ìˆ¨ê²¨ì§„ ë³„ì„ ì°¾ìœ¼ì„¸ìš”.", setup: setupHiddenStars('â­', 5), hint: "ë³„ë“¤ì´ ë°°ê²½ìƒ‰ê³¼ ë¹„ìŠ·í•˜ê²Œ ìˆ¨ì–´ìˆì–´ìš”. ëˆˆì„ í¬ê²Œ ëœ¨ê³  ì°¾ì•„ë³´ì„¸ìš”." },
            { question: "ì‚¬ìë¥¼ ìš°ë¦¬ì— ê°€ë‘ì„¸ìš”.", setup: setupBuildCage('ğŸ¦'), hint: "ì‡ ì°½ì‚´ë“¤ì„ ë“œë˜ê·¸í•´ì„œ ì‚¬ì ì£¼ë³€ì— ìš°ë¦¬ë¥¼ ë§Œë“œì„¸ìš”." },
            { question: "ë¬¼ê³ ê¸°ë¥¼ ë‚šì•„ë³´ì„¸ìš”.", setup: setupDragAndDrop('ğŸ£', 'ğŸ '), hint: "ë‚šì‹¯ëŒ€ë¥¼ ë¬¼ê³ ê¸° ìª½ìœ¼ë¡œ ê°€ì ¸ê°€ì„¸ìš”." },
            { question: "ê°€ì¥ ë¹ ë¥¸ ë™ë¬¼ì„ ê³ ë¥´ì„¸ìš”.", setup: setupRiddleWithOptions(['ë§', 'ì¹˜íƒ€', 'íƒ€ì¡°'], 'ì¹˜íƒ€'), hint: "ìœ¡ì§€ì—ì„œ ê°€ì¥ ë¹ ë¥¸ ë™ë¬¼ì€ ì¹˜íƒ€ì…ë‹ˆë‹¤." },

            // 61-80
            { question: "í’ì„ ì„ í„°ëœ¨ë¦¬ì§€ ë§ˆì„¸ìš”.", setup: () => { puzzleArea.innerHTML = '<div class="text-8xl">ğŸˆ</div><button class="absolute bottom-4 bg-blue-500 text-white py-2 px-4 rounded" onclick="completeLevel()">ë‹¤ìŒ</button>'; }, hint: "í’ì„ ì„ ê±´ë“œë¦¬ì§€ ë§ê³  'ë‹¤ìŒ' ë²„íŠ¼ì„ ëˆŒëŸ¬ ë„˜ì–´ê°€ì„¸ìš”." },
            { question: "ê°•ì•„ì§€ì—ê²Œ 'ì•‰ì•„'ë¼ê³  ë§í•´ë³´ì„¸ìš”.", setup: setupPasswordInput('ì•‰ì•„', 'ğŸ¶'), hint: "ë¬¸ì œì— ë‚˜ì˜¨ ê·¸ëŒ€ë¡œ 'ì•‰ì•„'ë¼ê³  ì…ë ¥í•´ë³´ì„¸ìš”." },
            { question: "ì¼€ì´í¬ì— ì´›ë¶ˆì„ ì¼œì£¼ì„¸ìš”.", setup: setupCombine('ğŸ•¯ï¸', 'ğŸ‚', 'ğŸ‚'), hint: "ë¶ˆì´ ì¼œì§„ ì´ˆë¥¼ ì¼€ì´í¬ ìœ„ë¡œ ê°€ì ¸ê°€ì„¸ìš”." },
            { question: "ì¼€ì´í¬ì˜ ì´›ë¶ˆì„ êº¼ì£¼ì„¸ìš”.", setup: setupClickToDisappear('ğŸ”¥', 3, 'ğŸ‚'), hint: "ì¼€ì´í¬ ìœ„ ì´›ë¶ˆë“¤ì„ ì†ìœ¼ë¡œ í„°ì¹˜í•´ì„œ ë„ì„¸ìš”." },
            { question: "ì–´ë–¤ ë¬¸ì´ ì§„ì§œì¼ê¹Œìš”?", setup: setupRealDoor(), hint: "ì˜¤ë¥¸ìª½ ë¬¸ì€ í†µê³¼í•  ìˆ˜ ìˆì„ì§€ë„ ëª¨ë¦…ë‹ˆë‹¤." },
            { question: "ë¹¨ê°„ìƒ‰ê³¼ íŒŒë€ìƒ‰ì„ ì„ì–´ë³´ì„¸ìš”.", setup: setupColorMix('ğŸ”´', 'ğŸ”µ', 'ğŸŸ£'), hint: "ë¹¨ê°„ìƒ‰ ë™ê·¸ë¼ë¯¸ë¥¼ íŒŒë€ìƒ‰ ìœ„ë¡œ ê²¹ì³ë³´ì„¸ìš”." },
            { question: "ê°€ì¥ ì‘ì€ ì ì„ í´ë¦­í•˜ì„¸ìš”.", setup: () => { questionEl.innerHTML = "ê°€ì¥ ì‘ì€ ì ì„ í´ë¦­í•˜ì„¸ìš”<span class='text-red-500 cursor-pointer' onclick='completeLevel()'>.</span>"; }, hint: "ë¬¸ì œ ë¬¸ì¥ ëì— ìˆëŠ” ë§ˆì¹¨í‘œ(.)ê°€ ê°€ì¥ ì‘ì€ ì ì…ë‹ˆë‹¤." },
            { question: "í¼ì¦ì„ ë§ì¶°ë³´ì„¸ìš”.", setup: setupJigsawPuzzle(), hint: "ê°€ë§Œíˆ ìˆìœ¼ë©´ ì €ì ˆë¡œ ë§ì¶°ì§‘ë‹ˆë‹¤. ì¸ë‚´ì‹¬ì„ ê°€ì§€ì„¸ìš”." },
            { question: "ì§€êµ¬ë¥¼ êµ¬í•´ì£¼ì„¸ìš”!", setup: setupDragAway('â˜„ï¸', 'ğŸŒ'), hint: "ì§€êµ¬ë¡œ ë‚ ì•„ì˜¤ëŠ” ìš´ì„ì„ ì†ìœ¼ë¡œ ì¡ì•„ì„œ í™”ë©´ ë°–ìœ¼ë¡œ ë˜ì ¸ë²„ë¦¬ì„¸ìš”." },
            { question: "ì•ˆì „í•˜ê²Œ ê¸¸ì„ ê±´ë„ˆê²Œ í•´ì£¼ì„¸ìš”.", setup: setupCrossTheRoad('ğŸš¶', 'ğŸš—'), hint: "ì‚¬ëŒì„ ìœ„ë¡œ ë“œë˜ê·¸í•´ì„œ ì°¨ë¥¼ ë›°ì–´ë„˜ê²Œ í•˜ì„¸ìš”." },
            { question: "ì±…ì„ ìˆœì„œëŒ€ë¡œ ê½‚ìœ¼ì„¸ìš”.", setup: setupSortItems(['ğŸ“–3', 'ğŸ“–1', 'ğŸ“–4', 'ğŸ“–2'], ['ğŸ“–1', 'ğŸ“–2', 'ğŸ“–3', 'ğŸ“–4']), hint: "ì±… í‘œì§€ì— ì“°ì¸ ìˆ«ìë¥¼ ë³´ê³  1, 2, 3, 4 ìˆœì„œë¡œ ì •ë ¬í•˜ì„¸ìš”." },
            { question: "ê°€ì¥ ë†’ì€ ìˆ«ìë¥¼ í´ë¦­í•˜ì„¸ìš”.", setup: setupHighestNumber(), hint: "í™”ë©´ì—ì„œ ê°€ì¥ ë†’ì€ ìœ„ì¹˜ì— ìˆëŠ” ìˆ«ìë¥¼ ì°¾ì•„ë³´ì„¸ìš”." },
            { question: "ë¡œë´‡ì„ ì¡°ë¦½í•´ì£¼ì„¸ìš”.", setup: setupAssembleRobot(['ğŸ¤–', 'ğŸ¦¾', 'ğŸ¦¿']), hint: "ë¶€í’ˆë“¤ì„ ê°€ìš´ë°ë¡œ ëª¨ì•„ë³´ì„¸ìš”. ì €ì ˆë¡œ ì¡°ë¦½ë©ë‹ˆë‹¤." },
            { question: "ìœ ë ¹ì„ ë¬¼ë¦¬ì³ì£¼ì„¸ìš”.", setup: setupDragAndDrop('ğŸ‘»', 'ğŸ’¨', true), hint: "ë°”ëŒ ì´ëª¨ì§€ë¥¼ ìœ ë ¹ì—ê²Œ ê°€ì ¸ê°€ ë‚ ë ¤ë²„ë¦¬ì„¸ìš”." },
            { question: "ì°½ë¬¸ì„ ì—´ì–´ì£¼ì„¸ìš”.", setup: setupSlideToOpen('ğŸªŸ'), hint: "ì°½ë¬¸ì„ ì˜†ìœ¼ë¡œ ìŠ¬ë¼ì´ë“œí•˜ë“¯ ë°€ì–´ë³´ì„¸ìš”." },
            { question: "ì´ ì¤‘ì— ìŠ¤íŒŒì´ëŠ” ëˆ„êµ¬ì¼ê¹Œìš”?", setup: setupFindDifferent(['ğŸˆ', 'ğŸˆ', 'ğŸˆ', 'ğŸ•', 'ğŸˆ'], 'ğŸ•'), hint: "ê³ ì–‘ì´ë“¤ ì‚¬ì´ì— ê°œ í•œ ë§ˆë¦¬ê°€ ìˆ¨ì–´ìˆë„¤ìš”." },
            { question: "ë²„íŠ¼ì„ ëˆ„ë¥´ì§€ ë§ˆì„¸ìš”!", setup: () => { puzzleArea.innerHTML = '<div class="w-32 h-32 bg-red-500 text-white rounded-full flex items-center justify-center text-3xl cursor-pointer" onclick="handleWrongAnswer()">ëˆ„ë¥´ì‹œì˜¤</div>'; patienceTimer = setTimeout(completeLevel, 4000); }, cleanup: () => clearTimeout(patienceTimer), hint: "4ì´ˆë§Œ ê¸°ë‹¤ë¦¬ë©´ ì•„ë¬´ê²ƒë„ ëˆ„ë¥´ì§€ ì•Šì•„ë„ í´ë¦¬ì–´ë©ë‹ˆë‹¤." },
            { question: "ë©”ëª¨ë¥¼ ì°¾ìœ¼ì„¸ìš”.", setup: setupHiddenObject('ğŸ“', 'ğŸ—’ï¸', 'ğŸ“„', true), hint: "ì¢…ì´ë“¤ì„ í•˜ë‚˜ì”© ë“œë˜ê·¸í•´ì„œ ì¹˜ì›Œë³´ë©´ ì•„ë˜ì— ë©”ëª¨ê°€ ìˆ¨ê²¨ì ¸ ìˆì–´ìš”." },
            { question: "ë‹¤ì´ì•„ëª¬ë“œë¥¼ í›”ì¹˜ì„¸ìš”.", setup: setupMaze('ğŸ’'), hint: "ë¯¸ë¡œë¥¼ í†µê³¼í•˜ë ¤ í•˜ì§€ ë§ˆì„¸ìš”. ê·¸ëƒ¥ ê¸°ë‹¤ë¦¬ì„¸ìš”." },
            { question: "ìƒˆë¥¼ ë‚ ë ¤ë³´ë‚´ì„¸ìš”.", setup: setupEscape('ğŸ¦'), hint: "ìƒˆë¥¼ ì¡ì•„ì„œ í™”ë©´ ìœ„ìª½ìœ¼ë¡œ ë˜ì ¸ë³´ì„¸ìš”." },

            // 81-100
            { question: "ì–¼ìŒì„ ë…¹ì—¬ì£¼ì„¸ìš”.", setup: setupCombine('â˜€ï¸', 'ğŸ§Š', 'ğŸ’§'), hint: "í•´ë¥¼ ì–¼ìŒ ìœ„ë¡œ ê°€ì ¸ê°€ë©´ ë…¹ì¼ ìˆ˜ ìˆì–´ìš”." },
            { question: "ì„±ëƒ¥ê°œë¹„ 1ê°œë¥¼ ì˜®ê²¨ ì‹ì„ ì™„ì„±í•˜ì„¸ìš”. 1+1=3", setup: setupMatchstickPuzzle(), hint: "ì´ê±´ ìƒìƒë ¥ ë¬¸ì œì…ë‹ˆë‹¤. ê·¸ëƒ¥ ê¸°ë‹¤ë¦¬ë©´ í•´ê²°ë©ë‹ˆë‹¤." },
            { question: "ì „í™”ë¥¼ ë°›ì•„ì£¼ì„¸ìš”.", setup: setupSwipeToAnswer('ğŸ“'), hint: "ì „í™”ê¸° ì•„ì´ì½˜ì„ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ìŠ¬ë¼ì´ë“œí•´ì„œ ì „í™”ë¥¼ ë°›ìœ¼ì„¸ìš”." },
            { question: "ìƒìë¥¼ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì˜®ê¸°ì„¸ìš”.", setup: () => { questionEl.innerHTML = "ì´ <span class='draggable text-blue-500'>ìƒì</span>ë¥¼ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì˜®ê¸°ì„¸ìš”."; makeDraggable(questionEl.querySelector('.draggable')); puzzleArea.innerHTML = '<div class="absolute right-4 border-2 p-4">ì—¬ê¸°</div>'; }, hint: "ë¬¸ì œì— ìˆëŠ” 'ìƒì'ë¼ëŠ” ê¸€ìë¥¼ ë“œë˜ê·¸í•´ë³´ì„¸ìš”." },
            { question: "ëª¨ë“  ë™ë¬¼ì„ ì°¾ì•„ë³´ì„¸ìš”.", setup: setupFindAll(['ğŸ’', 'ğŸ˜', 'ğŸ…'], 3), hint: "í™”ë©´ ê³³ê³³ì— ìˆ¨ì–´ìˆëŠ” ë™ë¬¼ë“¤ì„ ëª¨ë‘ í„°ì¹˜í•˜ì„¸ìš”." },
            { question: "ê±°ê¾¸ë¡œ í•´ë„ ë˜‘ê°™ì€ ë‹¨ì–´ëŠ”?", setup: setupRiddleWithOptions(['LEVEL', 'EYE', 'NOON'], 'LEVEL'), hint: "'LEVEL'ì€ ê±°ê¾¸ë¡œ í•´ë„ 'LEVEL'ì…ë‹ˆë‹¤." },
            { question: "í•´ê³¨ì„ í´ë¦­í•˜ì§€ ë§ˆì„¸ìš”!", setup: setupAvoidClicking('ğŸ’€', ['ğŸ˜€', 'ğŸ˜‡', 'ğŸ˜']), hint: "í•´ê³¨ì´ ì•„ë‹Œ ë‹¤ë¥¸ ì›ƒëŠ” ì–¼êµ´ë“¤ì„ í„°ì¹˜í•˜ì„¸ìš”." },
            { question: "ì—´ì‡ ë¡œ ë¬¸ì„ ì—¬ì„¸ìš”.", setup: setupDragAndDrop('ğŸ”‘', 'ğŸšª'), hint: "ì—´ì‡ ë¥¼ ë¬¸ìœ¼ë¡œ ê°€ì ¸ê°€ì„¸ìš”." },
            { question: "íŒì½˜ì„ íŠ€ê²¨ì£¼ì„¸ìš”.", setup: setupCombine('ğŸŒ½', 'ğŸ”¥', 'ğŸ¿'), hint: "ì˜¥ìˆ˜ìˆ˜ë¥¼ ë¶ˆ ìœ„ë¡œ ê°€ì ¸ê°€ë©´ íŒì½˜ì´ ë©ë‹ˆë‹¤." },
            { question: "ê°€ì¥ ì•„ë˜ì— ìˆëŠ” ë¬¼ê±´ì€?", setup: setupFindBottom(['ğŸ', 'ğŸŒ', 'ğŸ‡'], 'ğŸ'), hint: "ê°€ì¥ ì•„ë˜ì— ê¹”ë ¤ìˆëŠ” ê³¼ì¼ì„ ëˆŒëŸ¬ë³´ì„¸ìš”." },
            { question: "ë‚  ìˆ˜ ì—†ëŠ” ìƒˆëŠ”?", setup: setupFindDifferent(['ğŸ¦…', 'ğŸ¦‰', 'ğŸ§', 'ğŸ•Šï¸'], 'ğŸ§'), hint: "í­ê·„ì€ ë‚ ì§€ ëª»í•˜ëŠ” ìƒˆì…ë‹ˆë‹¤." },
            { question: "ğŸŒ²+ğŸŒ²=10, ğŸŒ²+ğŸ”¥=7, ğŸ”¥=?", setup: setupRiddleWithOptions(['2', '3', '5'], '2'), hint: "ë‚˜ë¬´ëŠ” 5, ë¶ˆì€ 2ì…ë‹ˆë‹¤." },
            { question: "ê³µì„ í™”ë©´ ë°–ìœ¼ë¡œ êº¼ë‚´ì„¸ìš”.", setup: setupEscape('âš½'), hint: "ê³µì„ ë“œë˜ê·¸í•´ì„œ í™”ë©´ ë°–ìœ¼ë¡œ ë˜ì ¸ë²„ë¦¬ì„¸ìš”." },
            { question: "ëª¨ë“  ë¶ˆì„ ì¼œì„¸ìš”.", setup: setupLightsOut(3), hint: "ì´ê²ƒë„ ì–´ë ¤ìš´ ë¬¸ì œì…ë‹ˆë‹¤. ì ì‹œ ê¸°ë‹¤ë¦¬ë©´ í•´ê²°ë©ë‹ˆë‹¤." },
            { question: "ì™¼ìª½ ì‹ ë°œì„ ì°¾ì•„ì£¼ì„¸ìš”.", setup: setupFindPair('ğŸ‘Ÿ'), hint: "ì˜¤ë¥¸ìª½ ì‹ ë°œì„ ì¢Œìš°ë°˜ì „ ì‹œí‚¨ ê²ƒì´ ì™¼ìª½ ì‹ ë°œì…ë‹ˆë‹¤." },
            { question: "ê°€ì¥ ê¸´ ê·¸ë¦¼ìë¥¼ ë§Œë“œì„¸ìš”.", setup: setupShadow(), hint: "í•´ê°€ ì›€ì§ì´ë©´ ê·¸ë¦¼ì ê¸¸ì´ë„ ë³€í•©ë‹ˆë‹¤. ì ì‹œ ê¸°ë‹¤ë ¤ë³´ì„¸ìš”." },
            { question: "ìˆ¨ê²¨ì§„ ìˆ«ìë¥¼ ì°¾ìœ¼ì„¸ìš”.", setup: setupHiddenNumber('7'), hint: "ë°°ê²½ìƒ‰ê³¼ ê±°ì˜ ê°™ì€ ìƒ‰ìœ¼ë¡œ ìˆ«ìê°€ ìˆ¨ê²¨ì ¸ ìˆìŠµë‹ˆë‹¤." },
            { question: "A, B, C, D, ... ë‹¤ìŒì€?", setup: setupRiddleWithOptions(['E', 'F', 'G'], 'E'), hint: "ì •ë‹µì€ Eì…ë‹ˆë‹¤." },
            { question: "ë‹¹ì‹ ì˜ IQëŠ”?", setup: setupPasswordInput('', 'ğŸ§ ', 'ì•„ë¬´ê±°ë‚˜ ì…ë ¥!'), hint: "ì–´ë–¤ ë‹µì„ ì…ë ¥í•´ë„ ì •ë‹µì…ë‹ˆë‹¤. ë‹¹ì‹ ì˜ IQëŠ” ìµœê³ !" },
            { question: "ê°œë°œìì—ê²Œ ë°•ìˆ˜ë¥¼!", setup: setupClap(5), hint: "ê°œë°œìë¥¼ ìœ„í•´ ë°•ìˆ˜ ì´ëª¨ì§€ë¥¼ ì—¬ëŸ¬ ë²ˆ ëˆŒëŸ¬ì£¼ì„¸ìš”!" }
        ];
        
        // --- Screen Management ---
        function showScreen(screen) {
            [startScreen, levelSelectScreen, gameScreen, gameCompleteScreen].forEach(s => s.classList.add('hidden'));
            screen.classList.remove('hidden');
        }

        function showLevelSelect() {
            levelGrid.innerHTML = '';
            for (let i = 1; i <= TOTAL_LEVELS; i++) {
                const btn = document.createElement('button');
                btn.className = 'level-btn h-14 bg-blue-500 hover:bg-blue-600 text-white font-bold rounded-lg flex items-center justify-center text-xl relative transition-all';
                if (i <= unlockedLevel) {
                    btn.textContent = i;
                    btn.onclick = () => loadLevel(i - 1);
                } else {
                    btn.innerHTML = `<span>${i}</span><span class="level-lock absolute text-3xl">ğŸ”’</span>`;
                    btn.disabled = true;
                }
                levelGrid.appendChild(btn);
            }
            showScreen(levelSelectScreen);
        }

        // --- Game Flow ---
        function loadLevel(levelIndex) {
            if (levels[currentLevelIndex]?.cleanup) levels[currentLevelIndex].cleanup();
            currentLevelIndex = levelIndex;
            if (levelIndex >= levels.length) {
                showGameComplete();
                return;
            }
            levelIndicator.textContent = levelIndex + 1;
            questionEl.innerHTML = levels[levelIndex].question;
            puzzleArea.innerHTML = ''; 
            puzzleArea.style.overflow = 'hidden'; // Reset overflow
            levels[levelIndex].setup();
            showScreen(gameScreen);
        }

        function showGameComplete() {
            gameCompleteScreen.classList.remove('hidden');
        }

        function completeLevel() {
            unlockedLevel = Math.max(unlockedLevel, currentLevelIndex + 2);
            if (currentLevelIndex >= levels.length -1) {
                nextLevelButton.classList.add('hidden');
            } else {
                nextLevelButton.classList.remove('hidden');
            }
            successModal.classList.remove('hidden');
            setTimeout(() => successModal.querySelector('div').classList.remove('scale-95'), 10);
        }

        function nextLevel() {
            successModal.classList.add('hidden');
            successModal.querySelector('div').classList.add('scale-95');
            loadLevel(currentLevelIndex + 1);
        }

        function handleWrongAnswer() {
            if (patienceTimer) clearTimeout(patienceTimer);
            gameContainer.classList.add('shake');
            setTimeout(() => gameContainer.classList.remove('shake'), 500);
        }

        // --- Setup Functions for Levels ---
        function setupFindDifferent(items, answer, shuffle = true) {
            return () => {
                if (shuffle) items.sort(() => Math.random() - 0.5);
                items.forEach(emoji => {
                    const div = document.createElement('div');
                    div.textContent = emoji;
                    div.className = "text-5xl cursor-pointer transition-transform hover:scale-125";
                    div.onclick = () => (emoji === answer) ? completeLevel() : handleWrongAnswer();
                    puzzleArea.appendChild(div);
                });
            };
        }

        function setupDragAndDrop(targetEmoji, draggableEmoji, isDraggableCover = false) {
            return () => {
                const target = document.createElement('div');
                target.textContent = targetEmoji;
                target.className = `text-8xl absolute bottom-8 right-8 ${isDraggableCover ? 'z-0' : 'z-10'}`;
                const draggable = document.createElement('div');
                draggable.textContent = draggableEmoji;
                draggable.className = `draggable text-7xl top-8 left-8 ${isDraggableCover ? 'z-10' : 'z-0'}`;
                puzzleArea.append(target, draggable);
                makeDraggable(draggable, () => {
                    const targetRect = target.getBoundingClientRect();
                    const draggableRect = draggable.getBoundingClientRect();
                    const isOverlapping = !(draggableRect.right < targetRect.left || draggableRect.left > targetRect.right || draggableRect.bottom < targetRect.top || draggableRect.top > targetRect.bottom);
                    if (isOverlapping) completeLevel();
                });
            };
        }
        
        function setupShake(treeEmoji, fruitEmoji) {
            return () => {
                const tree = document.createElement('div');
                tree.textContent = treeEmoji;
                tree.className = 'text-9xl absolute bottom-0 right-1/2 translate-x-1/2';
                const fruit = document.createElement('div');
                fruit.id = 'fruit';
                fruit.textContent = fruitEmoji;
                fruit.className = 'text-4xl absolute top-0 right-0 transition-all duration-1000';
                tree.appendChild(fruit);
                puzzleArea.appendChild(tree);

                if (typeof DeviceMotionEvent.requestPermission === 'function') {
                     DeviceMotionEvent.requestPermission().then(permissionState => {
                        if (permissionState === 'granted') {
                            window.addEventListener('devicemotion', handleShake);
                        }
                    }).catch(console.error);
                } else {
                     window.addEventListener('devicemotion', handleShake);
                }
            }
        }
        
        function handleShake(event) {
             if (!event.acceleration) return;
             if (event.acceleration.x > 15 || event.acceleration.y > 15) {
                const fruit = document.getElementById('fruit');
                if (fruit) {
                    fruit.style.transform = 'translateY(150px)';
                    setTimeout(() => {
                        completeLevel();
                        window.removeEventListener('devicemotion', handleShake);
                    }, 1000);
                }
            }
        }

        function setupTrickWord(items, trickWordId) {
            return () => {
                items.forEach(emoji => {
                    const div = document.createElement('div');
                    div.textContent = emoji;
                    div.className = "text-6xl cursor-pointer transition-transform hover:scale-125";
                    div.onclick = handleWrongAnswer;
                    puzzleArea.appendChild(div);
                });
                document.getElementById(trickWordId).onclick = completeLevel;
            };
        }
        
        function setupColorTextTrick() {
            return () => {
                const colors = [{ text: 'ë¹¨ê°„ìƒ‰', color: 'text-blue-500' }, { text: 'ë…¸ë€ìƒ‰', color: 'text-green-500' }, { text: 'íŒŒë€ìƒ‰', color: 'text-red-500' }, { text: 'ì´ˆë¡ìƒ‰', color: 'text-yellow-500' }];
                colors.sort(() => Math.random() - 0.5);
                colors.forEach(item => {
                    const button = document.createElement('button');
                    button.textContent = item.text;
                    button.className = `w-2/5 text-2xl font-bold p-4 rounded-lg ${item.color} bg-gray-200 hover:bg-gray-300`;
                    button.onclick = () => (item.text === 'íŒŒë€ìƒ‰') ? completeLevel() : handleWrongAnswer();
                    puzzleArea.appendChild(button);
                });
            }
        }
        
        function setupTshirtHoles() {
            return () => {
                puzzleArea.innerHTML = `<div class="text-9xl relative">ğŸ‘•<div class="absolute top-1/2 left-1/3 w-4 h-4 bg-gray-100 rounded-full"></div><div class="absolute top-2/3 left-2/3 w-4 h-4 bg-gray-100 rounded-full"></div></div><div id="answer-options" class="w-full flex justify-center gap-4 absolute bottom-4"></div>`;
                ['5ê°œ', '6ê°œ', '8ê°œ'].forEach(option => {
                    const button = document.createElement('button');
                    button.textContent = option;
                    button.className = 'text-xl font-bold p-3 rounded-lg bg-white hover:bg-gray-200 w-20';
                    button.onclick = () => (option === '8ê°œ') ? completeLevel() : handleWrongAnswer();
                    document.getElementById('answer-options').appendChild(button);
                });
            }
        }

        function setupHiddenObject(mainEmoji, hiddenEmoji, coverEmoji, isCoverDraggable = true) {
            return () => {
                const main = document.createElement('div');
                main.textContent = mainEmoji;
                main.className = "text-8xl absolute bottom-8 right-8";
                const hidden = document.createElement('div');
                hidden.textContent = hiddenEmoji;
                hidden.className = "text-5xl absolute top-10 left-10 z-0 cursor-pointer";
                hidden.onclick = completeLevel;
                const cover = document.createElement('div');
                cover.textContent = coverEmoji;
                cover.className = `text-9xl top-8 left-8 z-10 ${isCoverDraggable ? 'draggable' : ''}`;
                puzzleArea.append(main, hidden, cover);
                if (isCoverDraggable) makeDraggable(cover);
            }
        }

        function setupMakeLargestNumber(digits, answer) {
            return () => {
                const dropZone = document.createElement('div');
                dropZone.id = 'drop-zone';
                dropZone.className = 'w-4/5 h-24 bg-gray-200 rounded-lg flex items-center justify-center text-4xl text-gray-400';
                dropZone.textContent = 'ì—¬ê¸°ì— ìˆ«ìë¥¼ ë†“ìœ¼ì„¸ìš”';
                puzzleArea.appendChild(dropZone);

                const digitContainer = document.createElement('div');
                digitContainer.className = 'w-full flex justify-center gap-4 absolute bottom-4';
                digits.forEach(digit => {
                    const div = document.createElement('div');
                    div.textContent = digit;
                    div.className = 'draggable text-6xl w-16 h-16 flex items-center justify-center';
                    makeDraggable(div, () => {
                        let currentOrder = Array.from(puzzleArea.querySelectorAll('.draggable')).sort((a, b) => a.getBoundingClientRect().left - b.getBoundingClientRect().left).map(d => d.textContent).join('');
                        dropZone.textContent = currentOrder;
                        if (currentOrder === answer) completeLevel();
                    });
                    digitContainer.appendChild(div);
                });
                puzzleArea.appendChild(digitContainer);
            }
        }
        
        function setupDragAway(emoji, targetEmoji) {
            return () => {
                 const item = document.createElement('div');
                 item.textContent = emoji;
                 item.className = 'draggable text-9xl z-10';
                 if(targetEmoji) {
                    const target = document.createElement('div');
                    target.textContent = targetEmoji;
                    target.className = 'text-8xl z-0';
                    puzzleArea.appendChild(target);
                 }
                 puzzleArea.appendChild(item);
                 makeDraggable(item, () => {
                    const itemRect = item.getBoundingClientRect();
                    const areaRect = puzzleArea.getBoundingClientRect();
                    if(itemRect.right < areaRect.left || itemRect.left > areaRect.right || itemRect.bottom < areaRect.top || itemRect.top > areaRect.bottom) {
                        completeLevel();
                    }
                 });
            }
        }

        function setupPasswordInput(password, emoji, placeholder = "ì •ë‹µ ì…ë ¥") {
            return () => {
                puzzleArea.innerHTML = `
                    <div class="text-8xl mb-4">${emoji}</div>
                    <input id="password-input" type="text" class="w-4/5 p-2 text-center rounded-lg border-2" placeholder="${placeholder}">
                `;
                const input = document.getElementById('password-input');
                input.oninput = () => {
                    if (password === '' || input.value === password) completeLevel();
                };
            }
        }

        function setupEscape(emoji) {
             return () => {
                 const item = document.createElement('div');
                 item.textContent = emoji;
                 item.className = 'draggable text-6xl';
                 puzzleArea.appendChild(item);
                 puzzleArea.style.overflow = 'visible';
                 makeDraggable(item, () => {
                    const itemRect = item.getBoundingClientRect();
                    const containerRect = gameContainer.getBoundingClientRect();
                    if(itemRect.right < containerRect.left || itemRect.left > containerRect.right || itemRect.bottom < containerRect.top || itemRect.top > containerRect.bottom) {
                        completeLevel();
                    }
                 });
            }
        }
        
        function setupHiddenCount(emoji, answer, options) {
            return () => {
                puzzleArea.innerHTML = `
                    <div class="text-7xl absolute top-1/4 left-1/4">${emoji}</div>
                    <div class="text-7xl absolute top-1/2 left-1/2">${emoji}</div>
                    <div class="draggable text-7xl absolute top-1/3 left-2/3 z-10">${emoji}</div>
                    <div class="text-7xl absolute top-1/3 left-2/3 z-0">${emoji}</div>
                    <div id="answer-options" class="w-full flex justify-center gap-4 absolute bottom-4"></div>
                `;
                makeDraggable(puzzleArea.querySelector('.draggable'));
                options.forEach(option => {
                    const button = document.createElement('button');
                    button.textContent = option;
                    button.className = 'text-xl font-bold p-3 rounded-lg bg-white hover:bg-gray-200 w-20';
                    button.onclick = () => (parseInt(option) === answer) ? completeLevel() : handleWrongAnswer();
                    document.getElementById('answer-options').appendChild(button);
                });
            }
        }

        function setupPattern(options, answer) {
            return () => {
                options.forEach(option => {
                    const div = document.createElement('div');
                    div.textContent = option;
                    div.className = "text-6xl cursor-pointer transition-transform hover:scale-125";
                    div.onclick = () => (option === answer) ? completeLevel() : handleWrongAnswer();
                    puzzleArea.appendChild(div);
                });
            }
        }

        function setupCombine(item1Emoji, item2Emoji, resultEmoji) {
            return () => {
                const item1 = document.createElement('div');
                item1.textContent = item1Emoji;
                item1.className = 'draggable text-8xl top-8 left-8';
                const item2 = document.createElement('div');
                item2.id = 'target';
                item2.textContent = item2Emoji;
                item2.className = 'text-8xl bottom-8 right-8';
                puzzleArea.append(item1, item2);

                makeDraggable(item1, () => {
                    const rect1 = item1.getBoundingClientRect();
                    const rect2 = item2.getBoundingClientRect();
                    if(!(rect1.right < rect2.left || rect1.left > rect2.right || rect1.bottom < rect2.top || rect1.top > rect2.bottom)) {
                        item2.textContent = resultEmoji;
                        item2.classList.add('transition-transform', 'duration-500', 'scale-150');
                        item1.remove();
                        setTimeout(completeLevel, 500);
                    }
                });
            }
        }

        function setupSequenceButtons() {
            return () => {
                let bluePressed = false;
                const blueBtn = document.createElement('button');
                blueBtn.className = 'w-2/5 h-24 bg-blue-500 text-white font-bold rounded-lg text-2xl';
                blueBtn.textContent = 'íŒŒë€ ë²„íŠ¼';
                blueBtn.onclick = () => { bluePressed = true; blueBtn.style.opacity = '0.5'; };

                const greenBtn = document.createElement('button');
                greenBtn.className = 'w-2/5 h-24 bg-green-500 text-white font-bold rounded-lg text-2xl';
                greenBtn.textContent = 'ì´ˆë¡ ë²„íŠ¼';
                greenBtn.onclick = () => {
                    if (bluePressed) completeLevel();
                    else handleWrongAnswer();
                };
                puzzleArea.append(blueBtn, greenBtn);
            };
        }

        // --- NEW SETUP FUNCTIONS ---

        function setupClickToDisappear(emoji, count, baseEmoji = '') {
            return () => {
                if (baseEmoji) puzzleArea.innerHTML = `<div class="text-9xl">${baseEmoji}</div>`;
                for(let i=0; i < count; i++) {
                    const item = document.createElement('div');
                    item.textContent = emoji;
                    item.className = 'text-5xl cursor-pointer absolute';
                    item.style.top = `${Math.random() * 80}%`;
                    item.style.left = `${Math.random() * 80}%`;
                    item.onclick = (e) => {
                        e.target.remove();
                        if (puzzleArea.childElementCount === (baseEmoji ? 1 : 0)) completeLevel();
                    };
                    puzzleArea.appendChild(item);
                }
            }
        }

        function setupRiddleWithOptions(options, answer, emoji = '') {
            return () => {
                if(emoji) puzzleArea.innerHTML = `<div class="text-8xl">${emoji}</div>`;
                const container = document.createElement('div');
                container.className = 'w-full flex justify-center gap-4 absolute bottom-4';
                options.forEach(option => {
                    const button = document.createElement('button');
                    button.textContent = option;
                    button.className = 'text-xl font-bold p-3 rounded-lg bg-white hover:bg-gray-200 w-24';
                    button.onclick = () => (option === answer) ? completeLevel() : handleWrongAnswer();
                    container.appendChild(button);
                });
                puzzleArea.appendChild(container);
            }
        }
        
        function setupDeviceOrientation() {
            return () => {
                puzzleArea.innerHTML = '<div class="text-7xl">ğŸ“±</div><p>ê¸°ê¸°ë¥¼ 180ë„ ë’¤ì§‘ì–´ì£¼ì„¸ìš”</p>';
                window.addEventListener('deviceorientation', handleOrientation);
            };
        }

        function handleOrientation(event) {
            if (event.beta > 150 || event.beta < -150) {
                completeLevel();
                window.removeEventListener('deviceorientation', handleOrientation);
            }
        }
        
        function setupDraggableLength() {
            return () => {
                ['short', 'medium', 'long'].forEach((type, i) => {
                    const bar = document.createElement('div');
                    bar.style.height = '20px';
                    bar.style.backgroundColor = 'teal';
                    bar.style.position = 'absolute';
                    bar.style.top = `${30 + i * 20}%`;
                    bar.style.left = `25%`;
                    bar.style.width = type === 'long' ? '100px' : '50px';
                    if (type === 'long') {
                         bar.className = 'draggable';
                         makeDraggable(bar);
                         bar.onclick = completeLevel;
                    } else {
                         bar.onclick = handleWrongAnswer;
                    }
                    puzzleArea.appendChild(bar);
                });
            }
        }

        function setupClickCounter(targetCount) {
             return () => {
                let count = 0;
                puzzleArea.innerHTML = `<div id="counter-btn" class="w-32 h-32 bg-green-500 rounded-full flex items-center justify-center text-white text-3xl cursor-pointer">0</div>`;
                const btn = document.getElementById('counter-btn');
                btn.onclick = () => {
                    count++;
                    btn.textContent = count;
                    if(count === targetCount - 1) btn.textContent = '??';
                    if(count === targetCount) {
                        btn.onclick = null;
                        setTimeout(completeLevel, 300);
                    }
                }
             }
        }
        
        function setupEnlargeAndDrop(emojiToDrag, emojiTarget) {
            return () => {
                const target = document.createElement('div');
                target.textContent = emojiTarget;
                target.className = 'text-7xl transition-transform duration-500';
                target.onclick = () => target.style.transform = 'scale(2.5)';
                const draggable = document.createElement('div');
                draggable.textContent = emojiToDrag;
                draggable.className = 'draggable text-8xl absolute top-4 left-4';
                puzzleArea.append(target, draggable);
                makeDraggable(draggable, () => {
                    const targetRect = target.getBoundingClientRect();
                    const draggableRect = draggable.getBoundingClientRect();
                    const isOverlapping = !(draggableRect.right < targetRect.left || draggableRect.left > targetRect.right || draggableRect.bottom < targetRect.top || draggableRect.top > targetRect.bottom);
                    if (isOverlapping && target.style.transform === 'scale(2.5)') {
                         completeLevel();
                    }
                });
            }
        }

        function setupClickToChange(from, to, count) {
            return () => {
                for(let i=0; i<count; i++) {
                    const item = document.createElement('div');
                    item.textContent = from;
                    item.className = 'text-5xl cursor-pointer';
                    item.dataset.state = 'off';
                    item.onclick = () => {
                        item.textContent = to;
                        item.dataset.state = 'on';
                        const allOn = [...puzzleArea.children].every(child => child.dataset.state === 'on');
                        if (allOn) completeLevel();
                    };
                    puzzleArea.appendChild(item);
                }
            }
        }

        function setupDynamicTarget() {
             return () => {
                const fruits = ['ğŸ', 'ğŸŒ', 'ğŸ‡', 'ğŸ“'];
                fruits.forEach(f => {
                    const fruit = document.createElement('div');
                    fruit.textContent = f;
                    fruit.className = 'text-6xl cursor-pointer';
                    fruit.onclick = handleWrongAnswer;
                    puzzleArea.appendChild(fruit);
                });
                setTimeout(() => {
                    const newFruit = document.createElement('div');
                    newFruit.textContent = 'ğŸ‰';
                    newFruit.className = 'text-6xl cursor-pointer';
                    newFruit.onclick = completeLevel;
                    puzzleArea.insertBefore(newFruit, puzzleArea.firstChild);
                }, 1500);
             }
        }
        
        function setupMoveFinishLine(playerEmoji, finishEmoji) {
            return () => {
                const player = document.createElement('div');
                player.textContent = playerEmoji;
                player.className = 'text-7xl absolute top-1/2 left-4 -translate-y-1/2';
                const finish = document.createElement('div');
                finish.textContent = finishEmoji;
                finish.className = 'draggable text-9xl absolute top-1/2 right-4 -translate-y-1/2';
                puzzleArea.append(player, finish);
                makeDraggable(finish, () => {
                     const pRect = player.getBoundingClientRect();
                     const fRect = finish.getBoundingClientRect();
                     if (fRect.left < pRect.right) completeLevel();
                });
            }
        }
        
        function setupCountingGame(emoji, count) {
            return () => {
                 let sheepCount = 0;
                 const interval = setInterval(() => {
                    if (sheepCount >= count) {
                        clearInterval(interval);
                        return;
                    }
                    const s = document.createElement('div');
                    s.textContent = emoji;
                    s.className = 'absolute text-5xl';
                    s.style.top = `${Math.random() * 80}%`;
                    s.style.left = '-10%';
                    puzzleArea.appendChild(s);
                    setTimeout(() => {
                        s.style.transition = `left ${2 + Math.random() * 2}s linear`;
                        s.style.left = '110%';
                    }, 100);
                    setTimeout(() => s.remove(), 4000);
                    sheepCount++;
                 }, 800);
                 setupRiddleWithOptions([count-1, count, count+1].map(String), String(count))();
            }
        }
        
        // --- Draggable Logic ---
        function makeDraggable(element, onDropCallback) {
            element.addEventListener('mousedown', startDrag);
            element.addEventListener('touchstart', startDrag, { passive: false });
            function startDrag(e) {
                e.preventDefault();
                activeDraggable = element;
                activeDraggable.classList.add('dragging');
                const rect = activeDraggable.getBoundingClientRect();
                const parentRect = puzzleArea.getBoundingClientRect();
                if (e.type === 'touchstart') {
                    offsetX = e.touches[0].clientX - rect.left + parentRect.left;
                    offsetY = e.touches[0].clientY - rect.top + parentRect.top;
                } else {
                    offsetX = e.clientX - rect.left + parentRect.left;
                    offsetY = e.clientY - rect.top + parentRect.top;
                }
                document.addEventListener('mousemove', drag);
                document.addEventListener('touchmove', drag, { passive: false });
                document.addEventListener('mouseup', endDrag);
                document.addEventListener('touchend', endDrag);
            }
            function drag(e) {
                if (!activeDraggable) return;
                e.preventDefault();
                let x = e.type.startsWith('touch') ? e.touches[0].clientX : e.clientX;
                let y = e.type.startsWith('touch') ? e.touches[0].clientY : e.clientY;
                activeDraggable.style.left = `${x - offsetX}px`;
                activeDraggable.style.top = `${y - offsetY}px`;
            }
            function endDrag() {
                if (!activeDraggable) return;
                activeDraggable.classList.remove('dragging');
                document.removeEventListener('mousemove', drag);
                document.removeEventListener('touchmove', drag);
                document.removeEventListener('mouseup', endDrag);
                document.removeEventListener('touchend', endDrag);
                activeDraggable = null;
                if (onDropCallback) onDropCallback();
            }
        }
        
        // --- Initial Event Listeners ---
        startButton.addEventListener('click', () => {
            showLevelSelect();
        });

        nextLevelButton.addEventListener('click', nextLevel);
        selectLevelButton.addEventListener('click', () => {
            successModal.classList.add('hidden');
            showLevelSelect();
        });
        
        backToLevelsButton.addEventListener('click', showLevelSelect);
        backToMenuButton.addEventListener('click', () => showScreen(startScreen));
        
        hintButton.addEventListener('click', () => {
            const hint = levels[currentLevelIndex].hint;
            if (hint) {
                hintText.textContent = hint;
                hintModal.classList.remove('hidden');
            }
        });
        
        closeHintButton.addEventListener('click', () => {
            hintModal.classList.add('hidden');
        });

        restartButton.addEventListener('click', () => {
            unlockedLevel = 1;
            gameCompleteScreen.classList.add('hidden');
            showScreen(startScreen);
        });
        
        // --- Helper functions for new levels ---
        function setupClickablePart(emoji, area, callback) { return () => { puzzleArea.innerHTML = `<div class="text-9xl relative">${emoji}<map name="shape"><area shape="circle" coords="${area}" href="#"></map></div>`; puzzleArea.querySelector('area').onclick = callback; }}
        function setupTwoFingerSwipe(emoji) { return () => { puzzleArea.innerHTML = `<div class="text-9xl">${emoji}</div>`; let startDist = 0; puzzleArea.addEventListener('touchmove', e => { if(e.touches.length === 2) { let dist = Math.hypot(e.touches[0].pageX - e.touches[1].pageX, e.touches[0].pageY - e.touches[1].pageY); if(startDist > 0 && dist > startDist + 50) completeLevel(); startDist = dist; } }); }}
        function setupLightSwitches(count, target) { return () => { for(let i=0; i<count; i++) { const l = document.createElement('div'); l.textContent = 'ğŸ’¡'; l.className = 'text-5xl cursor-pointer opacity-50'; l.onclick = (e) => { e.target.classList.toggle('opacity-50'); if(i === target) completeLevel(); else handleWrongAnswer(); }; puzzleArea.appendChild(l); } }; }
        function setupCatchTheFly(emoji) { return () => { const fly = document.createElement('div'); fly.textContent = emoji; fly.className = 'absolute text-4xl cursor-pointer'; fly.onclick = completeLevel; puzzleArea.appendChild(fly); setInterval(() => { fly.style.top = `${Math.random()*90}%`; fly.style.left = `${Math.random()*90}%`; }, 800); }; }
        function setupBalanceScale(scale, item, count) { return () => { puzzleArea.innerHTML = `<div class="text-9xl">${scale}</div>`; for(let i=0; i<count; i++) { const brick = document.createElement('div'); brick.textContent = item; brick.className = 'draggable text-4xl absolute'; brick.style.left = `${20 + i*5}%`; brick.style.top = `${30 + (i%2)*10}%`; makeDraggable(brick); puzzleArea.appendChild(brick); } setTimeout(completeLevel, 5000); }; }
        function setupShellGame(shell, prize) { return () => { for(let i=0; i<3; i++) { const s = document.createElement('div'); s.textContent = shell; s.className = 'text-7xl cursor-pointer'; if(i===1) s.onclick=completeLevel; else s.onclick=handleWrongAnswer; puzzleArea.appendChild(s); } }; }
        function setupShakeToChange(from, withItem, to) { return () => { puzzleArea.innerHTML = `<div id="changeable" class="text-8xl">${from}</div><div class="text-5xl absolute bottom-4">${withItem}</div>`; window.addEventListener('devicemotion', e => { if (e.acceleration.x > 15) { document.getElementById('changeable').textContent = to; setTimeout(completeLevel, 500); } }); }; }
        function setupWipeScreen(sponge) { return () => { puzzleArea.innerHTML = `<div class="absolute inset-0 bg-yellow-900 bg-opacity-40 z-10" id="dirt"></div><div class="draggable text-7xl z-20">${sponge}</div>`; makeDraggable(puzzleArea.querySelector('.draggable'), () => { document.getElementById('dirt').style.opacity = '0'; setTimeout(completeLevel, 500); }); }; }
        function setupMoveTarget(item, target) { return () => { const i = document.createElement('div'); i.textContent = item; i.className = 'text-7xl absolute bottom-4'; const t = document.createElement('div'); t.textContent = target; t.className = 'draggable text-9xl'; puzzleArea.append(i,t); makeDraggable(t, () => { if(t.getBoundingClientRect().left < i.getBoundingClientRect().right) completeLevel(); }); }; }
        function setupCurrentTime() { return () => { const d = new Date(); const t = `${d.getHours()}:${String(d.getMinutes()).padStart(2, '0')}`; setupPasswordInput(t, 'â°')(); }; }
        function setupHiddenStars(star, count) { return () => { for(let i=0; i<count; i++) { const s = document.createElement('div'); s.textContent = star; s.className='absolute text-4xl cursor-pointer text-gray-200'; s.style.top=`${Math.random()*90}%`; s.style.left=`${Math.random()*90}%`; s.onclick=completeLevel; puzzleArea.appendChild(s); } }; }
        function setupBuildCage(animal) { return () => { puzzleArea.innerHTML = `<div class="text-8xl">${animal}</div>`; for(let i=0; i<4; i++) { const bar = document.createElement('div'); bar.className = 'draggable w-2 h-24 bg-gray-500'; makeDraggable(bar); puzzleArea.appendChild(bar); } setTimeout(completeLevel, 8000); }; }
        function setupRealDoor() { return () => { for(let i=0; i<3; i++) { const d = document.createElement('div'); d.textContent = 'ğŸšª'; d.className='text-8xl cursor-pointer'; if(i===2) d.onclick=completeLevel; else d.onclick=handleWrongAnswer; puzzleArea.appendChild(d); } }; }
        function setupColorMix(c1, c2, res) { return () => { const color1 = document.createElement('div'); color1.textContent=c1; color1.className='draggable text-8xl top-8 left-8'; const color2 = document.createElement('div'); color2.textContent=c2; color2.className='text-8xl bottom-8 right-8'; puzzleArea.append(color1,color2); makeDraggable(color1, () => { if(color1.getBoundingClientRect().left > color2.getBoundingClientRect().left-30) { color2.textContent = res; color1.remove(); setTimeout(completeLevel, 500); } }); }; }
        function setupJigsawPuzzle() { return () => { puzzleArea.innerHTML = '<div class="text-8xl">ğŸ§©</div>'; setTimeout(completeLevel, 2000); }; }
        function setupCrossTheRoad(p, c) { return () => { const person = document.createElement('div'); person.textContent = p; person.className = 'draggable text-6xl absolute bottom-0 left-1/2'; const car = document.createElement('div'); car.textContent = c; car.className = 'absolute text-7xl top-1/2 -left-1/4 animate-pulse'; car.style.animation = 'slide 4s linear infinite'; puzzleArea.append(person, car); makeDraggable(person, () => { if(person.getBoundingClientRect().top < car.getBoundingClientRect().bottom) completeLevel(); }); }; }
        function setupSortItems(items, sorted) { return () => { const container = document.createElement('div'); container.className = 'flex gap-2'; items.forEach(i => { const item=document.createElement('div'); item.textContent=i; item.className='draggable text-4xl'; makeDraggable(item, () => { const current = [...container.children].map(c=>c.textContent).join(''); if(current === sorted.join('')) completeLevel(); }); container.appendChild(item); }); puzzleArea.appendChild(container); }; }
        function setupHighestNumber() { return () => { puzzleArea.innerHTML = '<div class="absolute top-1/4 left-1/2 cursor-pointer" onclick="handleWrongAnswer()">5</div><div class="absolute top-1/2 left-1/4 cursor-pointer" onclick="handleWrongAnswer()">9</div><div class="absolute top-10 left-10 cursor-pointer text-2xl" onclick="completeLevel()">2</div>'; }; }
        function setupAssembleRobot(parts) { return () => { parts.forEach((p, i) => { const part = document.createElement('div'); part.textContent=p; part.className='draggable text-6xl'; part.style.top=`${20+i*20}%`; part.style.left=`${20+i*20}%`; makeDraggable(part); puzzleArea.appendChild(part); }); setTimeout(completeLevel, 6000); }; }
        function setupSlideToOpen(windowEmoji) { return () => { puzzleArea.innerHTML = `<div class="relative w-32 h-32 bg-blue-300 overflow-hidden"><div id="pane" class="absolute inset-0 bg-yellow-200 transition-transform duration-500 text-8xl">${windowEmoji}</div></div>`; document.getElementById('pane').onclick = (e) => { e.target.style.transform = 'translateX(80%)'; setTimeout(completeLevel, 500); }; }; }
        function setupMaze(prize) { return () => { puzzleArea.innerHTML = `<div class="text-4xl absolute bottom-2 right-2">${prize}</div>`; puzzleArea.onmousemove = handleWrongAnswer; setTimeout(completeLevel, 4000); }; }
        function setupMatchstickPuzzle() { return () => { puzzleArea.innerHTML = '<div class="text-4xl">1+1=3</div>'; setTimeout(completeLevel, 3000); }; }
        function setupSwipeToAnswer(phone) { return () => { puzzleArea.innerHTML = `<div class="text-8xl animate-bounce">${phone}</div>`; let startX=0; puzzleArea.addEventListener('touchstart', e => startX=e.touches[0].clientX); puzzleArea.addEventListener('touchend', e => { if(e.changedTouches[0].clientX > startX+100) completeLevel(); }); }; }
        function setupFindAll(items, count) { return () => { let found = 0; items.forEach(i => { const item = document.createElement('div'); item.textContent = i; item.className = 'absolute text-5xl cursor-pointer'; item.style.top = `${Math.random()*80}%`; item.style.left = `${Math.random()*80}%`; item.onclick = () => { item.style.opacity = '0.3'; found++; if (found===count) completeLevel(); }; puzzleArea.appendChild(item); }); }; }
        function setupAvoidClicking(danger, safe) { return () => { safe.forEach(s => { const item = document.createElement('div'); item.textContent=s; item.className='absolute text-5xl cursor-pointer'; item.style.top=`${Math.random()*80}%`; item.style.left=`${Math.random()*80}%`; item.onclick=completeLevel; puzzleArea.appendChild(item); }); const d = document.createElement('div'); d.textContent=danger; d.className='absolute text-5xl cursor-pointer'; d.style.top=`${Math.random()*80}%`; d.style.left=`${Math.random()*80}%`; d.onclick=handleWrongAnswer; puzzleArea.appendChild(d); }; }
        function setupFindBottom(items, answer) { return () => { items.reverse().forEach((item, i) => { const el = document.createElement('div'); el.textContent=item; el.className='absolute text-7xl'; el.style.bottom=`${20+i*10}%`; el.style.left=`${40 - i*5}%`; el.onclick = () => { if(item===answer) completeLevel(); else handleWrongAnswer(); }; puzzleArea.appendChild(el); }); }; }
        function setupLightsOut(size) { return () => { /* Complex logic, auto-complete for now */ setTimeout(completeLevel, 2000); }; }
        function setupFindPair(shoe) { return () => { puzzleArea.innerHTML = `<div class="text-6xl">${shoe}</div><div class="text-6xl -scale-x-100 cursor-pointer" onclick="completeLevel()">${shoe}</div><div class="text-6xl">${shoe}</div>`; }; }
        function setupShadow() { return () => { puzzleArea.innerHTML = '<div class="absolute top-10 right-10 text-6xl">â˜€ï¸</div><div class="w-10 h-20 bg-blue-500"></div><div id="shadow" class="w-10 h-2 bg-black opacity-50 transition-all"></div>'; setTimeout(() => { document.getElementById('shadow').style.width = '100px'; setTimeout(completeLevel, 1000); }, 500); }; }
        function setupHiddenNumber(num) { return () => { puzzleArea.innerHTML = `<div class="text-gray-200 text-8xl font-bold">${num}</div>`; setTimeout(completeLevel, 2000); }; }
        function setupClap(count) { return () => { let claps = 0; puzzleArea.innerHTML = `<button id="clap-btn" class="text-6xl">ğŸ‘</button>`; document.getElementById('clap-btn').onclick=()=>{ claps++; if(claps>=count) completeLevel(); }; }; }

    </script>
</body>
</html>

