<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>연결 중...</title>
    <style>
        body { font-family: sans-serif; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div class="loader"></div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        let target = urlParams.get('target');
        if (target) target = decodeURIComponent(target);

        function launchViaOtherBrowser() {
            if (!target) return;

            // 1. 대상 URL을 분석 (https://... 또는 myapp://...)
            let cleanUrl = target;
            let scheme = "https";
            
            if (target.includes("://")) {
                const parts = target.split("://");
                scheme = parts[0];
                cleanUrl = parts[1];
            }

            /**
             * 2. [핵심] 다른 브라우저(삼성 인터넷) 호출 인텐트 조립
             * 크롬이 아닌 삼성 인터넷 패키지명을 명시합니다.
             */
            const samsungIntent = `intent://${cleanUrl}#Intent;scheme=${scheme};package=com.sec.android.app.sbrowser;end`;

            // 3. 실행
            window.location.href = samsungIntent;
        }

        // 패턴 해제 감지
        document.addEventListener('visibilitychange', () => {
            if (document.visibilityState === 'visible') {
                // 크롬이 막고 있다면, 삼성 인터넷을 깨워서 target을 던집니다.
                launchViaOtherBrowser();
            }
        });

        // 초기 실행
        window.onload = () => {
            if (document.visibilityState === 'visible') {
                window.location.href = target; // 처음엔 그냥 시도
            }
        };
    </script>
</body>
</html>
